# ============================================================
# Veterans Verify - 环境变量配置
# ChatGPT Veterans 验证自动化系统
#
# 【使用方法】
# 1. 复制此文件为 .env：cp .env.example .env
# 2. 按照注释填写各配置项
# 3. 运行 python app.py 启动服务
#
# 【注意】
# - 标注 ⚠️必填 的配置项必须设置
# - 敏感信息请勿提交到 Git
# ============================================================


# ============================================================
# 【⚠️必填】基础配置
# ============================================================

# 服务监听端口
PORT=7870

# 调试模式（生产环境务必设为 false）
DEBUG=false

# Flask Session 密钥（⚠️请改为随机字符串，至少32位）
# 生成方法：python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=请改为随机字符串至少32位


# ============================================================
# 【⚠️必填】管理员认证
# ============================================================

# Web 管理界面登录用户名
ADMIN_USERNAME=admin

# Web 管理界面登录密码（⚠️请设置强密码）
ADMIN_PASSWORD=请设置管理员密码

# API 调用令牌（用于接口认证：Authorization: Bearer <token>）
# ⚠️请设置为长随机字符串
ADMIN_TOKEN=请设置API令牌


# ============================================================
# 【⚠️必填】临时邮箱服务配置
#
# 这是项目的核心依赖！需要你先部署 Cloudflare Worker 临时邮箱服务
# 参考项目：e:\test_band_gemini_mail
#
# 【配置说明】
# - WORKER_DOMAINS：你部署的 Worker API 域名（不含 https://）
# - EMAIL_DOMAINS：接收邮件的域名
# - ADMIN_PASSWORDS：Worker 的管理员密码（x-admin-auth）
#
# 【多邮箱配置】
# 如果有多个邮箱服务，用分号 ; 分隔，顺序必须一一对应：
#   WORKER_DOMAINS=api1.example.com;api2.example.com
#   EMAIL_DOMAINS=mail1.com;mail2.com
#   ADMIN_PASSWORDS=密码1;密码2
# ============================================================

# Worker API 域名（不含 https://）
# 例如：apimail.yourdomain.com
WORKER_DOMAINS=

# 邮箱域名
# 例如：yourdomain.com
EMAIL_DOMAINS=

# Worker 管理员密码
ADMIN_PASSWORDS=


# ============================================================
# 浏览器配置
#
# 本项目使用 Camoufox（Firefox C++ 级反检测浏览器）
# 无需额外安装浏览器，pip install 时会自动下载
# ============================================================

# 最大并发数（同时运行的验证任务数）
# 建议：1-2，太多容易触发风控
MAX_WORKERS=1

# 无头模式
# true = 后台运行（生产环境）
# false = 显示浏览器窗口（调试时使用）
HEADLESS=true

# 代理服务器（可选）
# 格式：socks5://ip:port 或 http://user:pass@ip:port
# ⚠️建议使用美国住宅代理，可提高成功率
PROXY_SERVER=

# 调试截图保存目录（可选）
# 设置后会在每个步骤保存截图，方便排查问题
DEBUG_SCREENSHOT_DIR=screenshots


# ============================================================
# 人类行为模拟参数
#
# 这些参数模拟真人操作节奏，是反检测的核心
# 建议使用默认值，除非你清楚在做什么
# ============================================================

# 打字延迟范围（毫秒）- 模拟人类打字速度
# 每输入一个字符后等待的时间
HUMAN_DELAY_MIN=50
HUMAN_DELAY_MAX=150

# 任务间隔范围（秒）- 每个验证任务之间的等待时间
# 设置较大间隔可降低被检测风险
REQUEST_INTERVAL_MIN=30
REQUEST_INTERVAL_MAX=120

# 字段切换延迟（秒）- 填完一个表单字段后的等待时间
FIELD_DELAY_MIN=0.3
FIELD_DELAY_MAX=0.8


# ============================================================
# 止损配置（风控保护机制）
#
# 当检测到异常时自动暂停，避免账号/IP被封禁
# ============================================================

# 最大连续失败次数
# 达到此数值后触发全局暂停
MAX_CONSECUTIVE_FAILURES=3

# 全局暂停冷却时间范围（秒）
# 触发全局暂停后，随机等待这个范围内的时间
COOLDOWN_MIN_SECONDS=180
COOLDOWN_MAX_SECONDS=480

# 单次失败冷却时间（秒）
# 单个任务失败后的等待时间
SINGLE_FAILURE_COOLDOWN_SECONDS=900

# Captcha/验证码触发后的冷却时间（秒）
# 遇到人机验证时的暂停时间
CAPTCHA_COOLDOWN_SECONDS=600


# ============================================================
# 浏览器指纹配置
#
# Camoufox 会自动生成真实指纹，以下用于特殊需求覆盖
# 一般使用默认值即可
# ============================================================

# 窗口大小（宽x高）
WINDOW_SIZE=1920x1080

# 时区（建议美国时区，与 Veterans 验证匹配）
TIMEZONE=America/Los_Angeles

# 语言区域
LOCALE=en-US

# 地理位置坐标（可选）
# 留空则由 Camoufox 根据 IP 自动匹配
GEO_LATITUDE=
GEO_LONGITUDE=


# ============================================================
# Profile 管理（高级功能，可选）
#
# 用于管理多个浏览器配置文件
# 每个 Profile 可以有独立的代理、指纹等配置
# ============================================================

# Profile 配置文件路径
PROFILE_CONFIG_PATH=./data/profiles.json

# Profile 分配策略
# round_robin = 轮流使用
# random = 随机选择
PROFILE_ASSIGN_STRATEGY=round_robin

# 默认 Profile 分组
PROFILE_DEFAULT_GROUP=

# Profile "坏标记" TTL（秒）
# 某个 Profile 出错后，暂时不使用的时间
PROFILE_BAD_TTL_SECONDS=900


# ============================================================
# 自动恢复配置
# ============================================================

# 自动恢复最大重试次数
AUTO_RECOVER_MAX_RETRIES=2

# 重试间隔退避时间（秒）
AUTO_RECOVER_BACKOFF_SECONDS=30


# ============================================================
# 验证流程配置
# ============================================================

# SheerID 验证页面 URL（一般不需要修改）
SHEERID_VERIFY_URL=https://services.sheerid.com/verify/690415d58971e73ca187d8c9/

# 邮件检查最大重试次数
# 等待 ChatGPT 验证码或 SheerID 验证链接
EMAIL_CODE_MAX_RETRIES=30

# 邮件检查间隔（秒）
EMAIL_CODE_CHECK_INTERVAL=3.0

# 页面加载超时（秒）
PAGE_LOAD_TIMEOUT=30

# 表单提交超时（秒）
SUBMIT_TIMEOUT=60


# ============================================================
# 数据持久化
# ============================================================

# 是否持久化任务数据
# true = 重启后保留任务记录
# false = 重启后清空
PERSIST_DATA=false

# 数据存储目录
DATA_DIR=./data

# 任务记录文件
TASKS_FILE=./data/tasks.json

# 验证结果文件
RESULTS_FILE=./data/results.json

# 保存防抖时间（秒）
SAVE_DEBOUNCE_SECONDS=1.0


# ============================================================
# 日志配置
# ============================================================

# 日志级别：DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# 日志文件路径（留空则只输出到控制台）
LOG_FILE=./logs/veterans-verify.log

# 单个日志文件最大大小（字节，默认10MB）
LOG_MAX_SIZE=10485760

# 日志备份文件数量
LOG_BACKUP_COUNT=5


# ============================================================
# IP 质量检测（可选，高级防护）
#
# IPQS 用于检测代理 IP 的质量和欺诈风险
# 可在高风控场景下使用
# 获取 API Key：https://www.ipqualityscore.com/
# ============================================================

IPQS_API_KEY=

# 最大允许的欺诈分数（0-100，越低越干净）
IPQS_MAX_FRAUD_SCORE=75


# ============================================================
# 限流配置
# ============================================================

# 同一标识符（邮箱/IP）在时间窗口内的最大请求次数
RATE_LIMIT_MAX_REQUESTS=3

# 时间窗口（毫秒，默认10分钟）
RATE_LIMIT_WINDOW_MS=600000


# ============================================================
# Camoufox 高级配置
# ============================================================

# 启用人类光标移动模拟（Camoufox 内置功能）
HUMANIZE_CURSOR=true

# 启用 GeoIP 自动指纹匹配
# 根据 IP 地理位置自动配置浏览器指纹
GEOIP_ENABLED=true

# Firefox Profile 目录（可选）
# 用于持久化 cookies 和会话
FIREFOX_PROFILE_DIR=


# ============================================================
# Docker / 部署相关
# ============================================================

# 健康检查端点
HEALTH_CHECK_PATH=/api/status

# 优雅关闭超时（秒）
SHUTDOWN_TIMEOUT=30
